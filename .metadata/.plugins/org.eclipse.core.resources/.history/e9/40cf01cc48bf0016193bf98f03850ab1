/* Name: Kenny Zhou
 * Date: 12/8/16
 * Project: Frac Calc
 */


package fracCalc;
import java.util.*;
public class FracCalc {

    public static void main(String[] args) 
    {
    	Scanner input = new Scanner(System.in);
    	System.out.println("Give Expression");
    	String expression = input.nextLine();
    	while (expression.indexOf("quit") < 0){
    	String givenString = input.toString();
    	System.out.println(produceAnswer(givenString));
    	}
    	
        // TODO: Read the input from the user and call produceAnswer with an equation
    	
    }
    
    // ** IMPORTANT ** DO NOT DELETE THIS FUNCTION.  This function will be used to test your code
    // This function takes a String 'input' and produces the result
    //
    // input is a fraction string that needs to be evaluated.  For your program, this will be the user input.
    //      e.g. input ==> "1/2 + 3/4"
    //        
    // The function should return the result of the fraction after it has been calculated
    //      e.g. return ==> "1_1/4"
    public static String produceAnswer(String input){
    String[] inputOperands = parseInput(input);
    int[] firstFrac = parseOperands(inputOperands[0]);
    int[] secondFrac = parseOperands(inputOperands[2]);
    String answer = "";
    if (inputOperands[1].equals("+")){
    	answer = addOrSubFrac(firstFrac, secondFrac, "+");
    }
    if(inputOperands[1].equals("-")){
    	answer = addOrSubFrac(firstFrac, secondFrac, "-");
    }
    if(inputOperands[1].equals("*")){
    	answer = multiplyOrDivideFrac(firstFrac, secondFrac, "*");
    }
    if(inputOperands[1].equals("/")){
    	answer = multiplyOrDivideFrac(firstFrac, secondFrac, "/");
    }
     return(answer);  
    }
 // TODO: Implement this function to produce the solution to the input
    // TODO: Fill in the space below with any helper methods that you think you will need
  
    
    public static String[] parseInput(String input){
    	String[] parsedExpression = input.split(" ");		 // Split by fractions and operators
    	return(parsedExpression);
    }
    
    public static int[] parseOperands(String operands){
        int[] parts = new int[2];
        int[] improperParts;
        parts[2] = 1;
        if(operands.contains("_")){
                String[] components = operands.split("");
                if (components[2] == "0"){
                	throw new IllegalArgumentException("Cannot divide by 0");
                }
                int wholeNumber = Integer.parseInt(components[0]);         			//changes whole number from a string to int
                parts[0] = wholeNumber;
                String fraction = components[1];
                String[] fractionComponents = fraction.split("/");
                int numerator = Integer.parseInt(fractionComponents[0]);            //changes numerator and denominator from string to int
                int denominator = Integer.parseInt(fractionComponents[1]);
                parts[1] = numerator;
                parts[2] = denominator;
        }else if(!operands.contains("_") && operands.contains("/")) {		    //if there is no whole number
                String[] splitFrac = operands.split("/");
                int numerator = Integer.parseInt(splitFrac[0]);
                int denominator = Integer.parseInt(splitFrac[1]);
                parts[1] = numerator;
                parts[2] = denominator;
        } else{
             String[] blank = operands.split(" ");
             int number = Integer.parseInt(blank[0]);
             parts[0] = number;
        }
        improperParts = toImproperFrac(parts[0], parts[1], parts[2]);
        return (improperParts);
        }

//    public static String parseOperands(String[] operands){
//    	String secondFrac = operands[2].toString();			 // Takes the second operand
//    	String[] wholePart = secondFrac.split("_");				 // Creates new array for the split integers
//    	int[] finalPieces = new int[2];					
//    	int wholeNum = Integer.parseInt(wholePart[0]);
//    	finalPieces[0] = wholeNum;
//    	String[] fracPart = wholePart[1].split("/");
//    	finalPieces[1] = Integer.parseInt(fracPart[0]);
//    	finalPieces[2] = Integer.parseInt(fracPart[1]);
//    	return("whole:" + finalPieces[0] +" numerator:" + finalPieces[1] + " denominator:" + finalPieces[2]);
//    }
    public static String addOrSubFrac(int[] firstOperand, int[] secondOperand, String operator){ 
    	int[] answer = new int[1];										// 	for answer: answer[0] = numerator, answer[1] = denominator
    	int commonDenominator;
    	int firstNumerator;
    	int secondNumerator;
    	if (operator.equals("+")){
    		if (firstOperand[1] == secondOperand[1]){					//checks if common denominator
    			answer[0] = firstOperand[0] + secondOperand[0];       	// adds numerators
    			answer[1] = firstOperand[1];							// takes denominator
    		}else{
    			commonDenominator = firstOperand[1] * secondOperand[1];
    			firstNumerator = firstOperand[0] * secondOperand[1];
    			secondNumerator = secondOperand[0] * firstOperand[1];
    			answer[0] = firstNumerator + secondNumerator;
    			answer[1] = commonDenominator;
    		}
    		return (answer[0] + "/" + answer[1]);
    	}else{
    		if (firstOperand[1] == secondOperand[1]){					//checks if common denominator
    			answer[0] = firstOperand[0] - secondOperand[0];       	// subtracts numerators
    			answer[1] = firstOperand[1];							// takes denominator
    		}else{
    			commonDenominator = firstOperand[1] * secondOperand[1];
    			firstNumerator = firstOperand[0] * secondOperand[1];
    			secondNumerator = secondOperand[0] * firstOperand[1];
    			answer[0] = firstNumerator - secondNumerator;
    			answer[1] = commonDenominator;
    		} 		
    	}
		return (answer[0] + "/" + answer[1]);
    }
    public static String multiplyOrDivideFrac(int[] firstOperand, int[] secondOperand, String operator){
    	int[] answer = new int[1];									// 	for answer: answer[0] = numerator, answer[1] = denominator
    	int numerator;
    	int denominator;
    	if (operator.equals("*")){
    		numerator = firstOperand[0] * secondOperand[0];
    		denominator = firstOperand[1] * secondOperand[1];
    	}else{
    		numerator = firstOperand[0] *secondOperand[1];
    		denominator = secondOperand[0] * firstOperand[1];   		
    	}
		answer[0] = numerator;
		answer[1] = denominator;
		return (answer[0] + "/" + answer[1]);
    }
	public static int[] toImproperFrac(int wholeNum, int numerator, int denominator){ // Takes a whole number and a fraction to turn it into an improper fraction
		int[] answer = new int[1];
		int imprprNumrtr = denominator * wholeNum + numerator;
		answer[0] = imprprNumrtr;
		answer[1] = denominator;
		return (answer);
	}
}


